import unittest

from poediscordbot.cogs.pob.util.treerenderer import TreeRenderer
from tests import TEST_DIR


class TestTreeRenderer(unittest.TestCase):

    def test_basic_tree(self):
        # bleed veq glad bottom right
        chosen_nodes = [829, 5237,
                        8370, 42911,
                        63439, 21435, 11497, 64265, 32091, 62588, 6741, 39861, 33989, 50515, 29993, 20807, 15616, 9206,
                        14090, 11568, 27864, 24133, 59606, 29937,
                        33179, 58854, 14726, 26528, 64235, 23334, 63194, 63921, 32555, 16167, 44103, 51974, 46882, 4207,
                        24496, 63710, 8544, 17833, 31471, 22266, 24083, 59766, 34483, 36221, 53615, 8419, 58271, 54127,
                        14292, 8930, 3109, 45593, 32763, 758, 52099, 48760, 18103, 6363, 6538, 26294, 19858, 6910,
                        42041,
                        47389, 17818, 49978, 23199, 10661, 61305, 12412, 34678, 60735, 1340, 8938, 33753, 29933, 18402,
                        56370, 24865, 46393, 43608, 12801, 40867, 36287, 16544, 17566, 54307, 43684, 51786, 56116,
                        11364,
                        476, 20812, 1675, 30679, 1461, 6799, 53114, 44316, 40132, 22994, 46665, 238, 6797, 1325, 19069,
                        34031, 5120, 25344, 27393, 8193, 8449, 10496, 20484, 20480, 24577, 8705, 10752, 24833, 8960,
                        26881,
                        11012, 23040, 20996, 20992, 23040, 25088, 27144, 15826, 8370, 64381, 62588, 21730, 29993, 37925,
                        51974, 3449, 63710, 28638, 53615, 47642, 44316, 59906, 46665]

        renderer = TreeRenderer(TEST_DIR + "/../resources/tree_3_20.min.json")
        svg = renderer.parse_tree(chosen_nodes=chosen_nodes,
                                  file_name=f"test_tree.svg",
                                  render_size=500)
        renderer.to_png(svg, f"test_tree.png")

    def test_scion(self):
        # bleed veq glad bottom right
        chosen_nodes = [55649, 5197, 49178, 64587, 6289, 46578, 44606, 65167, 28330, 19884, 30690, 4194, 15868, 14930,
                        46910, 25011, 33287, 24755, 15405, 36047, 33545, 41263, 193, 61198, 5152, 2913, 48287, 55485,
                        20551, 26523, 18865, 3644, 65034, 5233, 51923, 33875, 63799, 55247, 22285, 63048, 22627, 41472,
                        24383, 12702, 61320, 15144, 61471, 61437, 31683, 53118, 61875, 58449, 21650, 57279, 36881,
                        55676, 53793, 33631, 50904, 50862, 50288, 49772, 49379, 19287, 48778, 28284, 37671, 46092,
                        19144, 28221, 918, 35503, 6446, 31703, 30733, 44908, 24643, 25531, 26866, 30380, 62017, 28574,
                        44429, 33740, 19939, 15073, 30691, 13714, 62021, 31598, 18033, 43374, 2, 64381, 25011, 5356,
                        28284]

        renderer = TreeRenderer(TEST_DIR + "/../resources/tree_3_20.min.json")
        svg = renderer.parse_tree(chosen_nodes=chosen_nodes,
                                  file_name=f"test_scion_tree.svg",
                                  render_size=500)
        renderer.to_png(svg, f"test_scion_tree.png")
